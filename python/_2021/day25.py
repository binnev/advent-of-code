from copy import copy

raw = """>...>>.v>>>..>v.>...>>..>v>...v..>v....v>v>..>...>v.v.v>v..>vv..>v..v..v>.v>.v>v.v.v.v..>...>>..>.vv.v....vv...>>.....vv.v.v..v>.>>>..v>...
>>.vvv.>.>v.>v...>.>v>v>>>..>vv.>.>.>>...vv.v>.>...>v.>>..v...>>>v.v.>>..........>>.>..v.>..>..>>.v>v>>..v.....v>v>v>>>>.>..>..v.vvvvv..>>v
>vv.v....vvvvv>...>.v.....v>>>>v.......v.v.>....v.v.>..v...vv..vv.>...v.>..v.v.>.>.>..>>.>v>.>....>.v.v.v..v..vv>vv.>v>.....vv.>>>>>v>>>v>.
>v..>vvv..>>>...v.v...v>>>.....v.>.>vv.....>........vv.vv.vv.v.>.v...>v.v..>v>>.>>....v>.>>..v..v.v.>.......v>>...vv.vvvv.vvvv.vv.v...v.>>.
..>v>>...v.v>v..v..vv>.vvv>>.v.>v...v..v....vv>>>.....v.v>>.>v>v.>>.v>.v>.v>..>...>.>v.v..>>.v>>>...v>.vv.>.>>.>.v.vv>>>>.v.v>>..>.v>>v..v>
vv.v.>vv...>.>vv...>>.>.v.>...v...>v.vv>..>>>.>...vvvv>..vv.>>..vv.......v.>.>.>..v>v..>.v>v...v.v.>.v.>.>..v.>vv..v..>>..v.>.v...>v...>.v.
>>>v>v.>..v..>>.v....>>.vv>.>.v>..v>>>...>.v>.>v....v...>.>>vv...>v.>.v>.>.>>.v>>>...v>..vv>.v>v.>>..>...>..v.>..v.>>..v.>.>.v>..v.>>v.v.v.
.>.>v>vv.v..vvv.v>v...>v.v>.>......vv...>v..>vv>v>.v...v.>.....>.v...>.v...v>v.v..>..>>..>>v.>.....>v>vv..>vv.v.vvv..v>vv.>v.>vv..v.v>>v>.>
.v.v.v.v.>>>.v>.....vv.....v.v..>v.v.>>v>..>v.>v>.>.>..>v.v..v...v...vv.....v.vv.v.>v>.>..v.>v..v.v..>.>v...>v...>vv.>.v.v.>.>....>v>>...>.
>>.....>..v.>....v.>..>.>>.>>.v.v>>.>>v...>..v..vvvv>>.v..>.v>.v>>.>>..v..>>.>..vv..vv>v.v>>>vvv>>>.vv...vv..>.>>v.v>.>v>>>>.v.vvv....v.>..
..v..v>vv>>.>vv.v.....>v..vv..v........>.....v>>>..v..vv>>v>>v>>.vv.v..>>.....>.v....v>>.v>..>.>v.......v>.>..v..>>.v.vvvv>...vv.v..v..v...
>..>>.v.v......v..>>.v.v.....>>v....>.>.v>....v>v.>.v>>>>.>.>...>v>v...v...v.v...v.v..>..v.>...>>>v..>vv..v....>..>.v..>v.vv>>.vvv.v.>>vv.v
.>.>...>>..>.v....vv...v.>>>v>.>..>>.v..>.v>.>v..>v.v.v>>>v....>..>.>>..>.v>....vvv....>v>v..>>v...>>..vv.>v.>v.>vv.....vv....>>...v.v..>.v
v..v.>v.>.>>v.v....vvvv....v..>.v..v.v>...v..v..>.vvv>>.vv.....>>...>>.>vv.>.>v>..>.v..>.v>.>.>..v.v.>.>vv>vvv>.vv..v>>vv...vv>>>>..>>..vv>
.v>...>>....v>vv.>v.>.>.v.>vv...vvv.v>v.v>>.v>.v.v>v.>>.v>>>.>v...>>..v.>.>>.v>v..>>>vv....v.>>..v..>v>..>v>.v.v>...v.>vvv.vv...v....>.>.v>
......>v.>>>>...>>.>>vvv>>.....v..vv.>..v.>v>.>>>v.......>v..v.v.vvv>v......vv.>v.vv>>.v>vv.>...>..>v.>..>.v.v.>v.v.>.v..v.>>v...v>v..>v.vv
.v.>v.v>v>vv>>>>v>v..vvvv.>..vv.>>..>.vv.>v>..>..>v>>.......>>v...>..v.v....>..v..v>v..vv.>>>..>.......vv>.....>v>v.>..>v.>>>vv.>>.v..>vv>>
.>..v>>>>>v...v.v>>v.>vv..>v..>>.vv.v....v.>..v>>vv..vv.v..v>v..vvv......v....vv>.>.v>.>.>v....>.>.>.vv.>...v>v>...vv>.>.>..vv.v........v.>
.>vv....>vv..vvv....v..v...v.>>...v..v..>.vv.>..>>.v>v>.v....>>..v.>v>.v...v>.>....vv.v>.>>.>v>.>.v>.>....v.>.vv...>>v>.v>...>...>..>.>>..v
..v>>.>v.>>v>>.>vv>>.vv...vv>..>>vv>..v..v....vv.>>vvvv...>..>>.v..>.vv...v.>..vvv..v..v....>vv.v.vv....v.v..v..>vv>>.......>>....>.vv.>.>v
.v.v>v...>v..v..>.....>>..>..v>.v>v.v..v.v>..vv.>.>>.>...vv..v>v.vv......v.v..>>v....>.v.>..v.>.v...v..>v.vv.....v..>>v>....v>..>.v..>>..>>
v.v..>vv>>>v...>>vvv>>v>v>v...vv..>>v...>v>vv>...v.vv..vv.>>.>......>.v>...vv..vvv..>v>v>>>..v.>.>>>...v>..>..>....>vv..v..v..>.v.>...>v>>.
v..>..>....>>>v..v.>.v>...v.v..>>v.>v>>v..>...v........>v.>.vvv..>>.vv..>v....>>.>>vv>>vv>.>...v.>...v>>v>.>..>...vv.>v.v>.>vv.>v>.>.>v.>..
...v.>..v>v.v.v.vv.v....v.v.v..>v.>v.>.>.>>.vv>..v..v....v...v>>>.>>>v>>>>>v....>.>..>>>v>.>>>.v>vv..v>.>..>.v.v.>.>..>..vv..v..v..v.>...>v
vv.v.vv....v..v.>v>.........v.vv....>v...v>v.vvv>>.v.v....>>>>v...v.v>.v...>.>.>.v>....v>v....>...>.v.v...v..vv.>....>.>>..vv.v.vv.>.v.v.vv
>v>>.>.v>..>v>vv.>...v..>>...v>v.>.....v...v...>v.>...v.>....vv..>>v...vv..vv.v....>...>>>vvv.v...>.>..>.vv...>..vv>>..>..v..>....v...>v>.>
>>...v..>.>.....vv...>>v>.v..>v..vv>.>>.>....vv.>v...>>v>>....>.v.v..>..v>>>..vvvv>>......>v.>v>.>>.vv>.>.....v.v.>...>.>>>.>vv.>..>>.>.v>v
v..v.>>.>.v>v>.>....>>....v>...>.>vvv.v.>v.>..>..v>>>v.v..>...v>...v>vv..>v..>.vv..v.v>...>.vv.v.v>>>v.>..>..v.v>..>vvv.v>>vv.vvvv>.v>.....
>.v>.v.>..v>v>v..>..vv.>....>vv.>>.vvv...>>.>>>..>v>..v.v.v.v...>...vv..>.>....>>.>v>..vv.v.>v.v>v>>>v>v..>.v.>.vv.>>.v......>..v.>..v..vvv
..vv>>...v....>>.v....>>vv.>.vv>>.>...>v.>.....v.>>v>.v..vv..vv.>v>.v...>>>>....>>v.>v.>>>.>.v.>>v..vv...>....>.v>.v..v..v.>..v>>.>..>>.v>.
>>.v...v>>.v.....v>.v.v.>vvvv.v.>.>>..>>......vv.>..>.v>..>v......>>>.v...>>>..>v>.>>v>..v...vv.......v..>...vvvv.v.>v.v>.v>.>..>..v>>>v...
...v>.>.>.vv.>v>.vv..v.>>>.>v>.vv>.v.vv>v......v...>>v.>.>>.>vv.v.v.v>v.v....>>>>.v..>>.vv...v>.v>..v>>.>>>..>v>..v>.>.vv...v>..v.>>v>...>.
......>v...vv>...>.>>>...>.v>..v.v>...v.>>>..v>v.vvv.v..v.v...>>........>.vvv.>v...>.v.>.>v..v>...v>>.>.>vv..>>.>>v....v.....vv>>v.....v.>.
v.>.>....>........v.vv.v....v..>v.......>....v..>........v....>...v.>.v.>.>>>v......>.v..>>v.vv...v.v.>>>..vv.>>v.>v.>.....v.v>...>....>.vv
vv>.vv>>>.>.vv>....>>v>v..v...>v.>>.>.>.v>.>v..v>...>...v.v>.>v>>..>v>.>>>.v.>.>.>v>>..v..v....>.v.>v.v>v.>>v.v>.>..>vv>.v>.>>>..>>>>..>..>
..v.v>......v.vv..v..>..v..>vvv>>>>v..v...>v.v...v.>vv.vv..v>v.v..>...v.>>vvv>.v>v.>..v>v>.v>v>v....>>..v...>>>..vv..>.v>...vv>v.>.vv.v.v>.
vvv>.>v.>>v>.v....>....>.>>.v.>..v.v.v.v.>.>>...v...>..>.>.vv>v.>v>v>>..vvv>v.v>>v>...>..v.>v...>>>>.v..vvv......vv.vv.>v....v.>>.>>>vv.>v>
>v..>v.>..v>.v>.>.>.....v>vv.v.vv..v>v>v...v....v.v..v.vv>>>.>v.v.>.>.v..>.vv>.>.>.v.v.>....>..vvv...>.>>.v>.v>.....v.>v>.>.>...v>.v.>>>v>.
>>..>>vv.....>..v>>..>..>v..>>v...>>.>.v>..>>>>v.vv.v.>>.v.v>>.>v.>.>....vv>>v>.v.>.>v.>v>>...v>>.>..vv..>v....vv>>>.v>vv.v>.vv>>>.....vv.v
vv>.v>...v.>.>>...v...vv.v.>>v...>v.>.>v..v>>>v>..v.>v......>..v>>.v.vv..v....v.>>...>..>>......vv.>v.v..>.v..>.>.vv...>v.>>vvvv.v>.v.>>.v>
>..>.>>v.v.....>..v.>v.>..>>v>>vv......v..>.v.vv>>.v>...v..vv.>>..v...v...v..>.......>.>>....v.v>v>>v.v>>...>..>..vv>v.>.vv.v.>v>.>.>.>....
..v>>v.>..>v>.>..>.>...v>vvv>v..>>>vvv>>....v>v..>>>>...>v.v>vv.vv>v>.v.......v>.v>....v.>>.vv.v>..v..>v..v.>>v>.>v...>v.>>.>.vv>v>.>..vv>.
..>......>v........v...>>.v>>>v.v....>..>.v.>>>>v.vvv>vvv.vvv.>.vvv....>v..>..v>.vvv.vv>v>..>>.v.>v.>v.>..>v.v>vv...v.>>vv..vv.>.>.vv.v..>.
>..v.>v...>.vvv.>>...>vv...v..>..vvv..>.>>..v.>..>>.>vv..vv...>.>.v.>.>>.>v.>...>...v>v>.v..v.>.v.>.>..>>v>>.>..>...v....v..>.v.v>.v....v.>
.>vvv.>vvv.....>.v.v>.>.v.v.v..v......v.vv>.>..>.>>.vvv>>>..>..v..v.>.vv>>vv.>.>>>.>vv......v>..>>v......>v.>vv..v>>...v..v..>...>.>>>.>v.v
.v>>.v....vv>>vv>.>>..>...>v>v...v>>..>v......>..>v..v.>vv.v>>>.v>.vv>>v.vv.v...>>>.>.v.>.....v>...>...>.vv.v>.v.....v......v..>......>.>>v
v>.vv>...>>.v.vvvv>.>....>v..>vv..v>.>.>vv.v..>.v>.v..>.>>.v>.v>>v>.>>.v.v....>.v>v.v....>v.v...>vv.v>..>.v.>v.v.>.v>>v.>.>...v.v.....v....
..vvv.vv.v..>vv.>vvv.v>v..>vv.v..vv...>.>>.v.v.>..v..v>..v>..v.v>>>..v>>v.v...vv>...v..>>..vvv..>>....>v>v>...........vv.vvv.v>v.v>..>....v
v>v.......v>.v...vv...>v..v.>.>.>.....>>>.>>v.v....v.....v.>...>vv.v.v.vvv>........>....>vv..........v..>...>>.v>v>.>>...>..v.>.vvvvvv>....
.v>.>>.>>.v..v.v...>v.v..v>v>>vv.vv.....>v.v.....>...v.v>>...>....v.>v..vvvv..v.v..vvv.>>..v...>v>v>>>.....v>v.v..v.vv.>..v>vvvvv.>...>.>..
v....>.v>.v.v.>.v>.>v..>...>.>...vv.v>vv>>>..vv>.>v.vv.>v.>.v>...vvvv.>.vv.>.>>>..>.>.>v>v..vv.v...>.>.v>>v>v..>.>.vvv..v>.....>.>.>....v>v
>>v.v.vv>>.v>..>..>.>v>.v.>..>v>..vv>>..v>.....>>v.>.v>>vv>..v...v.v>..>.>v...vvv>..vv.>...>>.vv>.v.>....>vv.>v...vv>>...vvv..v.vvvv.vv...>
vv.....v....v...>..v.v.>.>v>.v..>...>...v>vv.>.>vv.....v....v....>....vv.>>v>...>..>..vv.>.v.vv.......>..v>.>>>vv>v.>>v...>.>>..v..v...v..>
..v.>.v.v>>>v.v.>v>.v>..v.>>>.>v.>..>.....>.>.>.>v...v.v>vv..v.v...>.>>..v>.......v.v.>>v...>.>.....>.>>v.....vvv.v>>>.>.>>..>v>....v.....>
>..>>..v..>.>..>..v.>...>.v.>.v.v.v.v.v...vv...>..vv.>>.v>..v.>v>.v..v>v>>vv.v.v..>..>..>..>>>>..>...vvv.v.v.>v>..v.v>..>...v..v..>....v.v.
>.vvv........>>v.>..vv.v>v.v>..v.v>>>..>....v>.>vv>>>>>>v...>...v>...>....>..vv...vv>....v>>>.>v.>v..v>>v...v.>.v.v.v.vv..>...>..v...v.>...
vvv.>>.v.....v.>>v>..>vv.v>v....v.>v>..>......v..>..v>>>.....v...v..>.v>...>v.v>v>..v......>v.v...>v.vvvvv.v>..v..vv.v....v...v..vv....v..v
.v>>.v>.>>..vv..>vvvv>>.>v..>v......vv.v>..>....v....>vv.>>.vvv.>>.v.v.>.>>..v>..v.>.>..>vvv.>>>.vv>vv.>......v>v.>.v..>>..>...>>v...>.v.vv
vv.>.vvv>>.vv...vv.>vv.v..vv..vv.vv.>v>>v........v....v.vvv.>....v.....vv>..>..>.v.vv.........v>..>vv>v.vv.v..v>..>....>.v..>.>>vv.>.v.v>..
v>...v>.>.vvvv>>.>..v..>v.v>.....>vv..v>.>....>v.>>.v.>.>>>v.v>>....v.>vvv..>...vvv...>.>vv.>.v.>>...>v...>.>..v..........v.vvv.v.>.v>>>v.>
>.vv>vv..v>>.>>vv.v.....v...v>..>>v....v.v>v.>>..>>..v..v.>v..v.v>>...>vv.>>.>.v....>..>vvv>v...>..>.>..v...>v>v..>.>>..>vvv>>.>.vv>..v..vv
.v..>v........>...v..v.>v.>>vv.>>.....>.v.....>..v>.>>v.v>v.v>>vv>>v>vv>vv..>..>vv..>..>v.>v...>v...v.vv.>....vv>..>.>..vv.v.>>.>..vv.>v.>.
vv.vv.v......>..v.v..>v..>>..>>......vv......>..vv.v>>..v>v>.>v.v.>>>.>v.>v..>vv>.vv.v>.vvv..>.v.........>....>>...>vv.vv>.vv.>.v.v>...>..>
>.v.v..>.>..vv...v.>....v.>v>..>.v>..v>v.>...>...v>.v..v.....>..>.vv>>>.>>>>>vv>.....>.>.v.>v....>>v>>>.>v.>.v..>.vvv>>.vvv.v..>v>...vv....
>.....vvv>...v.>..>.v.>vv.>v.v.......v.v..>>..vvvv..>vv>>.>v>.>.v>.....>>>.>...v....v.v>v.........>...vv.v.v.....>.v..>.v>.>.>.>.>>>..>.>..
v.>..vv..vv>>.v.>>v>.v>>>vv>>...v>..>>.>..>>.v>v...>.>v.>.>>>>vv>.>>.>v.v>>>>.....>.>.>>v....v.v>.v..v....v.vv..>>...vv.>>>>.v.>>.>...>vv.v
v.>.v>.>>..v>.>.v.vv>.>>>v..v.>..>v>v>>v>>>>v>...........>.>>.v>...>vv.v..>>..v.v.>.>v.....vv>>>..>>.>>>>...>...v>>.>..vv..v.v.>..v>vv....v
.>>>.>v>v.>vv.>..>>.v>...v..v>>..>v..v.v.>v.v.v>>>v.v.vvv>>...v>..vv>>..>.>....v>v..v..>v>.>vv>.v>.>...>.>.v>v.v>..vv.>....vvvv.v.>>.>>.>>>
>v.>.v>>...>...>.v....vv..vvvv.v.>>...v>v..v.....>>vv..>vv>...>>....v>v..v..vvvvv>>v>......>>.>...>v..v...v>..vv.>vv.>>...v......>vv>v..v..
vvv..v>>>...>..>>.v.>...>>...>>.v..>...>..vvvvvvv.v..>.>.>.v.>>>.vvvv.v..........v.v>>>v.vv.vv>v.v.>v>..>.>.vv...v...vv>>.v>>.>vv..v.>>>v..
.>.v....v...>>..>>>v.vv.v..v.v.v.v.>v...v.v...v..>vv........>......>..v.v>..>.v....v.>v..v>v..vv.>v....vv..v>.>.v..v>.>>v>>..vv..v....>v>vv
v>>v.>.>>>.vv......v..v.>..v.v.>.>>>>>.v...v>v>vvv>vv>..v..>v.>.>v....v.vv....vv>v.vvvv.>>.v>.vvvv...>....v.v>>>.v>>...vvv.>....>v.v>..v...
v>>>.>vvv>.....>..vv.>vv>..>..v>.v..v..vv.>.vvv...>.>v>..v.v>>>.>..v.vv.>.>.v.>>>>.>.vv.>>.>v>>.>v....>v>.v.>...vvvv.>>v>.v..>.>..>vv>..>..
>...vv.vv>....>.>.>>>>.v..v>.>v..v>..>v>v..>v.>..vv.>vv..v.>.v.v>v.>>.>....>>>>...v>>.v..>.v....>..>.>vv...>v.>>v.v>v.>v>...vv>v...>v.v...v
>v..v.v>>>.>v>..vv....>vv...>v.vvv.v>>....v...>v.>v..v.vv..>>v>>vv..>.>.....>...>.v.>>>>..>.....v>>>........>.v.>.>>.v.v.v.>>..vv...v.>.vvv
>.v>...>v..v.v.>.vv.v>v.v....v.>..vv>vvv.vv......>....>>v..v..>>.>...v>...v>v.v>.>>...>v....>..v>>v>>...>.vv...>v>.v>v>....>..>.>...>v..v>v
.>>v.>.>..>>..>..v>vv>vv....>vv....vv..v.v.v>>v.>>v...>>vv.....v.v.v.....v.>.>..>v>>.>v..>....>.>>..>>>>vv>..>...>....>..>.v.v..>...>...vvv
.>v>....v.>.v.v>.>>>.v.v.....v>>>>.v>v.....v>.v...>>>v......>.........v>...>>..>.v>.>..>..v.v.v>>>.........>v..vv>.>>.>.v>>>..>.v>>.>vv>>..
vvvv>.>.>.>.v.vv>>.>......>.>.v..>>.>v...v.>>>.v>>..>..vv.......>.>.vv.vv...v...v>.>v>v>v>v..vvv>v>>.vv.>>v..>.>v.v.v>>>.v...v.>>v..v....>v
>........>vv.v.vv.>v>v...>>...v>.>..>>.>>v...v.>>v>.>v.>>..vv.>v..v.v.>v....vvv>.>>.v.....v.v..vv..>.vv.v>v>>.v..>.>.v.v...v.>v.>...v>.....
..v.>vvv..>.v>..>.v.v.>>.........vv.v.v..v>...>>>v>..v>.>.v..>.>>.v>v..v>..v...>.>.>v.v>>v.v..>>...>.>.v.>....>>vv.>>..>....>.v>vvv.>.v..v.
..>...>>...>.v..v..>.>.v.....v>v>vv.>.>v.v..vvvv.vv...v.....vvv..>.v>...>.....v..>.>>>.>.v.v>.v>>v.v>..>....v....>>>>.>....v..>v....>v....v
v.>.v>..v..>.>.>v..v.>>v.>>........>>>..v>>.>>>v>vv.v>.>v.>v>....v>>v.vv.>.>>.>.v>.....>..v...>.......>v>.v>>....>.v..v.>..>v.v.>>>vvvvv..>
.>v>v.v.>vv.v...v..>..>>v...>...>.>..vvv>.v.>.>>..>vv>.v..vv>..vvvvv....>.....vv......vvv.>>>.v.>vv.>>v.>v..>>>>.vv>vv...v>>...>>..vv>>v...
..vv.vv.v....>.v...>vv..>v..>.>.v>.v.....>.>.>.v..v...v........>.v>>...>v......>..>>>v>v.vv>.v>v.>>..vvvv.v....>>>.v.>v.v..>.>.v.>..v.v>.v.
>.vv......vv....v..v>.>..>v>>.v.>v.....vv.v..>.v..v>v.>v.v.vv...>v.vv>...v...vv...v>.>.>v.v>.v>.>v..>.vv.v..v>vv>>...>>.v.v...v.>>.vv>.>..>
.>vvv.>>>v>vv>.>>v.>>>>vv.v>....v>.vv>.....>v...>.>vv>..>........>..vvvv>..>>.v.v>>v....v..vv.v>>v>..v>....v.v....v..v.v.>.v>..v..v..v>v>.>
...v...v..>v>>..>.vv.>....v>v..>>.>.>v>....>.v....v.v>vvv........vvv.>..>..v>v.....>..vv..vv>..>.>>>>...vv>>v>......>.>v.>..v>.....>>v...>.
.>v..v>v...>.>.>.v.>.v.>..v>>>>.>>>>...v....>..v.>.>v>..v>...>>>...v..>..v..v.>..>v>>.>v......>..>.>.vv.>>..vv>.......vv>.>v.vv>.>v..v..v..
>.....>v>..>..v.>...v>..>..>>vvv.v.>.>.>.>.v..>........vv.v...vvv>..v..>>..v.>...v..v.v.vv.v>.vvv.vvv..v....>v.>.vv...v.v.v.v>.>>.>v>v..v.v
.>v...>v.>..>>>>>>...v>v.v....v>.>v>.v.>..>>.>..>.>>v.v>>>.......>..v>>v.v....vvv....>.>.>vvv....>...vv..>.>>>.v.v.v>..>.vv>v.v.>v>>vvv>v>.
.v.>>.v.....>v..>..>v>......v.>v...>v.>.vvv>vv>..>vvv>.>..vvvvvv>>>...>....>.v...>v.vv..v.vv.v..v.>...>vv>..v>>.....>>.>..>..v...>v..v>.>..
...>>v..vv....>.v.v>>>>....>..>v...vv>.vvv.vv>v.v.>.v....v.v>.....>>.v...v...>>...>>.>.>>v>.>v>v...>>...>...vvv>...>.v.>.v>...vv.>v>.>.....
.v..v.>vv...v.....vvv.....>....v.vv.........v>v>>.>v..v>.>v..v..>>..>vvv.v..>..v..vv.vv..>>.>>.>v>>.>.>>.v.>..>>..>.vv.vvv.v.>>.>.>..>v..vv
.v...v>.>...>.v..v..v...>>.v.>.>.>>.>.>.>....>.vvv>.v.v.v>..>..>..v..v...v.>>...v.vvvv....v.vv..v>v.v...vv>>.>.v.......>v.v.v.vvv.vv..>v..>
...v>v.v..>v.>....v..>.v.......v.>.v>v....>>>.....>....>.>.>v>.v>>>..v>..>v>.v>......v>.>v.v.vvv.v.v.>>>..>>>.>>..v>>v......vv....>v>>>.v.>
..>vv......v>..v...v...>.v>>...v.....v>.>>>vvv.v..v>.v.v>.v..>>..>.>..>vv...>.>.>....vv>..>..v>>.....v>..>>.>>>v>>>.v.>..vv>.>vv.>>v.v..>.v
..vvv.v>v.vv....>v>>.v>v.>v.v..v.v....>v.vv..v.>..vv....>.>.>.>..>>v.v.vv...>v>v..v>.vv.v..v>.>v>>.v....>vv>...v>>v...vv.....v.....v>v..v.>
..>.v..v..>vv>>>..v.>>.v>>v.v..>>>.v>v...>..>.v>.v>>...vv.....v>vvv.......>.>.v...>>.v..>vvv>.vv.>.>v.....v.v>.>vv...>>v>>>>.vv.v.....vv...
...>.>....>.>....v..v..v..>..>v...v>>....vvv>>v>.>>.v..>>...v..>>>.>....>>>>..>.v>>..>.v.>..v..vv.vv>..>>....v.>.>...>>....vv..v..v...v.v.>
>....v>.v.>v.>>>v.>.>v>....>.v>v...>.........>v....v....v.vv>.>v.>...>v>.v..v.v.>.>..>...vv>..v>.vv.....v....v>>......>...>>..v.v>>..v.>.>>
>.>v..>>>v.vvv....>>.>.>.v..v....v.>.....>.vvv.v..>>...v.vvvv.>.v...>..>>>v.v..>.vvv...>.v>>>...v>..v..>.>....v.>>.vv..>.vv.v..vv..>>>>...v
v.>>.>v.>vv......>.>>....>v.v...v>...>.v..>>v.>>.>vvvv>vv.v.v.>>.v.v....>.>v.v.>>v>...vvvv.>.>.>>.>...>.>..>.v.>>>>v.>>....v>v.v...vv.v>>..
.>>v>.v>>v.v>.>....v.>..>v>>>v.....>>.>..>.vvv.>v.v>v.v..v>v>........v.v.v..>>v..>...v.v...>..v.v.>.>.v..>v>v...v.>...>v..v.>..v..>..>.v>.>
vv>.>.v>.v>>...v..v.v....>v>v>v.>.>....>.v>>.v.v.vv..>>v........>>..>v.....vvv>.>.v...v.v>..vv>.>>v>>...vvv>>..v..v.v...v..>v>v>..v.>>.v>v.
.v>vv.....v>v.v.v.>>>v.v>v.>>v>....>.>vv....v.>vv.>v.v.>..vv.........>v.vv.....>>.vvvvv>v>.v.>....v.v...v>v..>.vv.....v>>v.>..>v.v.v...v...
.v.>.vvv.>>>>>vvv..>.v..vv>>>vv..>>...v>.>.v>>..>.vvv.v.v...>..>.>.v.>>v...>..v.>.>......v>v.>v.....v.vv>v.>..v...>v.v.>....vvvv....>>..>.v
....v..>.>vvv>v..vv.v>>>v..>vvv.>v..>...>v.>v>v...>>..>v..v>..>.>>.....vvv..>vvv..>..>v>.v>vvv..vv..v.v..>.v.>v..>..>.v..>..v>.>v>...>.....
>>.vv.>.>....v...vv...vv....v..v..v..>v.......v..vv..>..>.v...vvv....>..v.>..v.vv...>.>>>>.v>>.>..>v.>v>v>v>.v.v>>v.v.v.v..v.v>>v...v>>v>.>
...>..>>v..v..v>v>vv...>v>v>v....>.>>>v>...vvv.>.v.v.>.v.>>.>.v.v.v...>........vv..>.v.vv>.>>>...v.>.>.>.v>>...vvv>.v>v...>v>v.v.vv........
.vv.....>...v.>>v..vv>>>>v.v.v.>v.>...vvv.vv.>.vv.>..>.>.>v>.>..>.v>vv...>>>.>>vvvvvv..vv....v..>.....>vv..>v.>.vvv.v.v>..>vv...v..>.vvv...
>..>v..>v>>v.>..>>..v.>.v>>v.v...>..>v.....vv.....vv>.vvv.v>..>>.v>.>.....v..vvv..>...>>v.>>v>>.>>.>v..v..v.v>.>v>.>v....vvv.>.v.v..vv.>.>.
.>..v>.>.v.>..>>..v....vv.v...v...v>.>..v>......v......>.v...v>>v...>.v..v.v>.>...v>...>.>>.....>v.....>.vv.........>.v.v>vv>..v.vv.>.>..>>
>>.v.vv..v>......>v..>vv...v>vv.v>..>...>....>v.v.>....v....vv.>>..>...>>..v>..v>...v...v.>v.v>......>........v.>..v>..v>..v.vvvv>..v>..v.v
..vvvv..>v.>>.v>.>..>.v.v>.vvv>>.v.>vvv.>>.vv>>.v>.>.vv>.>...>...v>>vv>..>....>.v..vv..vvv.v>.>...>..>..>>.>......>...v.v>.v..>vv..v..v.>.>
>.v>..>..v...>>>>......>.>>.vv...>vv.vv.vv.>>.v...........>>..>>..>.vvv.>.>.>...>v.>>...vv.v.vvv...>>>.>v....v..v.v....>.v>......>.v>.>vvv.
.>..>>...>>>...v.vvv.v>vv>.>v>v>.v....v........>.vv>>.>>>.vv.vv.>..>v.v.v>...>..v.v....vv.v>v.>..v...v>.>..>.>>..>>v>>.>v....>v.>>>.......v
..v...>>>..v.>.>.>>>v>>>v.v.v.>.v>....v.>v.>...>v..vv>.v.v>.>>..v>...>>.v>vv>>...v...v...>..>....>>.>>>v>v.>>.vv.>.v>>..v>v..v...>v.v..v>>.
>.v..>....v....>.....v.>v>v.v.>>...v>>vv...>>>v.vvv>....>v..v>v>.>..v....v>v.vv..v.>..>...>.>v....>.>>.>.vvv>v.v.v.>.v..>..>.v>.v.>>v>..>v.
..>.>v...vv...v....>.>.>>>vv.>...vv.v...>.v.>>.>>.>vv.>>..>v>..vv.>.vv.>>...vvv>.........>.>vv.>.v>..>v>>.>.v..>...>.....>vvv>..v....v>.v..
>.>..>v>....v...v...>>v..>>.>.>.>.>>v>>..>>..>..vv..>v>>>>>>.>.>>.>.vv...vv...v..>vvvvv...>..v..>vv.v.>...>v.>v..>.>......>v.>vv..v>..v.>v>
..v.>.vv>v..>...v>..v.....v>..>vv.v.>>v>>>..>.v.v..vv>.....>vv>...>....>>..>.>.>.>..>vv...vv>v>..>..>.>>.vv>vv.>.v..>..v.>.....>v.v.>.>>>>.
...v..v.>v>vv....vv.v>>>>..>vv..v.v>.vvv.....vvv.v.>....v.>.>>v>.>..v.....>>.>.v..v>>vv>..>..v.>..>..vv..>v>..>v..>.>...vv.>>...>>..>..v..>
.v...vv>>.>...vvv>v>.>.v>.v.>....>...>.>>>v>.>>vv>..v.>v>..>v.>.v...v.>>v..>v.v>vv>...>..>.v.v..>v.v.v>.v....>....v>....>>>...v...vv>.>>...
>..>.>...v>>...>.>.>>v.>>.v>.vv.>v>vv...v..>vv..>.>>.v.v.v>..>v..>vv.v>...>v.v..v..v>.v....v.>v..>..>.vv..v.v>>vvv>>v.v>v...vv>..>.>..v>.v>
..>.....v.v>>..vv>.....v..>...v....>>vv.>..v.>>...v..v>v.>...>..>>.v>vvv....>..v.v.>v.>>>....vv.>..>vv.v.>.>>>>.v>..>...>....v..>.v>.v...v.
.v.>.....>....vv.v..>..v>...>..v.>.>.vv.>.v.vv.>..>v>..v>..v..>.>vv.>..>.v.v>>>.>vv.v>.v.>>..>.v>>>...>...vv..>..>>v..v.vv.>.v..>v.>v.vv...
....v>>.>vv..vv.>v>....v..>.....>v...>.v..>>v.vv.v.vv>.....>.v>vv>.v>vv..>.>v.vv.>..>...>v>..>>v>>v..>>>.....>>>vvv.>.>.....vv.>>...>>...v.
>v...v>...>>..>..>..>>..>...>>..>.>..>>..v>vv.vv>..>>>.>>v....>..v..vv..v..v>.v.v>.vv.......>..>>...>>>>>>>.>.>.v>>..>.>.v......v.>v>.>.>>.
.>vv>v>..v.>v>v>..v.>v.v.>.>v.vvv>v..v..v>..>v..v.....>v...v>>v>v.vv...>>....vv....>>.v>>>v...>..v.vvvvv.vv>.vv..v.v.>.vvv>.>vv..v....v..v.
v>>>>..v.v...>.>>....>..v>>>..>.v.....v...>.>>.>.>>>>>...>>.v>.>..>.v.>>.>>.>...>v>v>.vv>vv.v.>.....>>.>..v.>....vv.vv.>..v..v>>v.>v.>v.>.v
.vv>>>..v>..v.v..>vv>>v.>.>...>>>.....>...v.v..vvv>v.v>vvv>vv.v..v...vv.v...>>>....vvv>v>.vv>>v...v>......v.v>v.>>..>.v>.v>.v.>v>....>..vv>
...>vvv>>v.>>.v>v>>>.v.>v>>..>.vv.vv>v>>..........v>vv>v.v..>.v.>...>>>.v.v>...v>>...v>.>..v..>>....v.vv...>.v.v.>.......>>v>v.v.>>>v.vv..>
>v.v....vv.v>v.>vv..v>.>..>...>.v>v...>.>>..>>>>v.>...v.....v.vv.v.......>.v..>.>v..>.vv.>.v.vv.>v.v.vv.vv>.v.v.>>>>...v..v..v>v..vv....>>.
>..>.vv>v.v.v>....>>.......>>.>v>>..>>>>>.>.vv>.v.v..v>>.>vv>v.v>v.vvv.>....v>..v.vv......v>vv.v..v>v>v...vv>>..vvv>.v.vv.>>....v.>>...v>v.
...v...>..>..v...v.>>.....>.....>.v..>>>>>>v.v>>.v>.v..>v.v..v.>.v.>v...>v..v..v>v..v...>v..v>.>...v.>>vv.>>.v>v>...>v>.>>>v...>..>>.>v>v..
.v>v>..>..v.....v....v.>>.>.>.v...v.vv.vv...>.v..v...>v.>...>....v..>>v..v.>>>>..v...>.v.v...>..v.v.v...v.vv.>vv...>.>....>...>.>>....vv>>."""

example = """v...>>.vv>
.vv>>.vv..
>>.>v>...v
>>v>>.>.v.
v>v.vv.v..
>.>>..v...
.vv..>.>v.
v.v..>>v.v
....v..v.>"""


class CucumberField(dict):
    def calculate_size(self):
        self.width, self.height = size(self)


def init(raw_string):
    cucumbers = CucumberField()
    for y, line in enumerate(raw_string.splitlines()):
        for x, char in enumerate(line):
            cucumbers[(x, y)] = char
    cucumbers.calculate_size()
    return cucumbers


def print_stuff(things):
    xs = [x for x, y in things]
    ys = [y for x, y in things]
    min_x = min(xs)
    max_x = max(xs)
    min_y = min(ys)
    max_y = max(ys)
    for y in range(min_y, max_y + 1):
        for x in range(min_x, max_x + 1):
            print(things[(x, y)], end="")
        print("")


def size(cucumbers):
    xs = [x for x, y in cucumbers]
    ys = [y for x, y in cucumbers]
    min_x = min(xs)
    max_x = max(xs)
    min_y = min(ys)
    max_y = max(ys)
    return (max_x - min_x) + 1, (max_y - min_y) + 1


def can_move(coords, cucumbers):
    x, y = coords
    cucumber = cucumbers[coords]
    if cucumber == ">":
        next_coords = ((x + 1) % cucumbers.width), y
    if cucumber == "v":
        next_coords = x, ((y + 1) % cucumbers.height)
    return next_coords if cucumbers[next_coords] == "." else False


def move(coords, new_coords, cucumbers):
    if new_coords:
        cucumbers[new_coords] = cucumbers.pop(coords)
        cucumbers[coords] = "."


def iterate(cucumbers):
    east_movers = [
        (coords, new_coords)
        for coords, cucumber in cucumbers.items()
        if cucumber == ">" and (new_coords := can_move(coords, cucumbers))
    ]
    for coords, new_coords in east_movers:
        move(coords, new_coords, cucumbers)

    south_movers = [
        (coords, new_coords)
        for coords, cucumber in cucumbers.items()
        if cucumber == "v" and (new_coords := can_move(coords, cucumbers))
    ]
    for coords, new_coords in south_movers:
        move(coords, new_coords, cucumbers)


def part1():
    cucumbers = init(raw)
    ii = 1
    while True:
        copycumbers = copy(cucumbers)
        iterate(cucumbers)
        if cucumbers == copycumbers:
            break
        ii += 1
    return ii


if __name__ == "__main__":
    p1 = part1()
    print(f"{p1=}")
    assert p1 == 295
